<!DOCTYPE html>
<html>
<head>
    <title>Decision Support Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .inhide {
            display: none;
        }

        .inhide:target {
            display: block;
        }

        .td_text{
            font-family: sans-serif;
            font-size: 12px; 
            text-align: right; 
            padding-right: 10px;
        }
        .inp_box{
            font-size:12px; 
            border-radius: 7px; 
            border-width:thin;  
            width: 200px; 
            height: 27px; 
            text-align: left; 
            vertical-align: middle; 
            padding-left: 10px; 
            padding-top:0px;'
        }
        .btn-style{
            width: 215px; 
            background-color: dodgerblue;
            color: white;
            font-weight: bold;
            border: none; 
            height: 30px; 
            border-radius: 7px; 
            text-align: center; 
            vertical-align: middle; 
            padding-top: 2px;
        }
        .card-header{
            font-family: sans-serif;
            text-size:18px;
            position: fixed;
            top: 0px;
            text-align: center;
            padding: 5px;
            border-bottom: 1px solid black;
            width: 100%;
            background-color: lightgreen;
            font-weight: bold;
        }

        .centered-button {
  			display: block;
  			margin: 0 auto;
  		}

        table {
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid black;
            padding: 5px;
        }

        th {
            background-color: lightgray;
        }

        td input {
            width: 50px;
            text-align: center;
        }
        body{
            margin-top: 50px;
            margin-bottom: 30px;
            margin-left: 20px;
        }
    </style>
    <div class= "card-header text-left">
        <h4><b>Technology Selection Tool </b></h4>
    </div>
</head>

<body>
    <form>
    	<h4><b>Select Indicators</b></h4>
    	<table>
    		<tr style="vertical-align: top;">
    			<td  style="width: 235px;">
				    <div>
				    	<h5>1. Economic Indicators</h5>
				        <input type="checkbox" name="indicate[]" value="Capex">Capital Cost<br/>
				        <input type="checkbox" name="indicate[]" value="Opex">Operational Cost<br/>
				        <input type="checkbox" name="indicate[]" value="Revenue">Revenue Cost<br/>
				        <input type="checkbox" name="indicate[]" value="LCC">Life Cycle Cost<br/>
				        <input type="hidden" name="num_textboxes" value="0" />
				    </div>
				    
				    <div style="padding-left: 18px;">
				        <div id="textboxes-container" ></div>
				        <input type="button" name="add_button" value="Add" onclick="addTextbox()" />
				    </div>
				</td>
				<td style="width: 275px;">
				    <div>
				    	<h5>2. Environmental Indicators</h5>
				        <input type="checkbox" name="indicate[]" value="GWP">Global Warming Potential<br/>
				        <input type="checkbox" name="indicate[]" value="EuP">Eutrophication Potential<br/>
				        <input type="checkbox" name="indicate[]" value="EcoSer">Ecosystem Services<br/>
				        <input type="hidden" name="num_textboxes1" value="0" />
				    </div>
				    
				    <div style="padding-left: 18px;">
				        <div id="textboxes-container1"></div>
				        <input type="button" name="add_button1" value="Add" onclick="addTextbox1()" />
				    </div>
	    		</td>
	    		<td style="width: 325px;">
				    <div>
				    	<h5>3. Circularity Potential Indicators</h5>
				        <input type="checkbox" name="indicate[]" value="WasRec">Wastewater recycling<br/>
				        <input type="checkbox" name="indicate[]" value="EnePot">Energy<br/>
				        <input type="checkbox" name="indicate[]" value="ProPot">Products (fertilizers, sludge etc)<br/>
				        <input type="hidden" name="num_textboxes2" value="0" />
				    </div>
				    
				    <div style="padding-left: 18px;">
				        <div id="textboxes-container2"></div>
				        <input type="button" name="add_button1" value="Add" onclick="addTextbox2()" />
				    </div>
				</td>
				<td style="width: 235px;">
				    <div>
				    	<h5>4. Social Indicators</h5>
				        <input type="checkbox" name="indicate[]" value="SocUnskill">Unskilled manpower<br/>
				        <input type="checkbox" name="indicate[]" value="SocAccept">Acceptability<br/>
				        <input type="checkbox" name="indicate[]" value="SocPart">Participation<br/>
				        <input type="hidden" name="num_textboxes3" value="0" />
				    </div>
				    
				    <div style="padding-left: 18px;">
				        <div id="textboxes-container3"></div>
				        <input type="button" name="add_button1" value="Add" onclick="addTextbox3()" />
				    </div>
	    		</td>
	    	</tr>
			<tr style="vertical-align: top;">
	    		<td>
				    <div>
				    	<h5>5. Resilience Indicators</h5>
				        <input type="checkbox" name="indicate[]" value="R_reli">Reliability<br/>
				        <input type="checkbox" name="indicate[]" value="R_dura">Durability<br/>
				        <input type="checkbox" name="indicate[]" value="R_flex">Flexibility<br/>
				        <input type="checkbox" name="indicate[]" value="R_repl">Replicability<br/>
				        <input type="hidden" name="num_textboxes4" value="0" />
				    </div>
				    
				    <div style="padding-left: 18px;">
				        <div id="textboxes-container4"></div>
				        <input type="button" name="add_button1" value="Add" onclick="addTextbox4()" />
				    </div>
				</td>
				<td >
				    <div>
				    	<h5>6. Technical Indicators</h5>
				        <input type="checkbox" name="indicate[]" value="BOD">Biochemical Oxygen Demand<br/>
				        <input type="checkbox" name="indicate[]" value="COD">Chemical Oxygen Demand<br/>
				        <input type="checkbox" name="indicate[]" value="Nitro">Total Kjeldahl Nitrogen<br/>
				        <input type="checkbox" name="indicate[]" value="Phosph">Phosphorus<br/>
				        <input type="checkbox" name="indicate[]" value="Em_cont">Emerging Contaminants<br/>
				        <input type="checkbox" name="indicate[]" value="Lan_suit">Land Suitability<br/>
				        <input type="hidden" name="num_textboxes5" value="0" />
				    </div>
				    
				    <div style="padding-left: 18px;">
				        <div id="textboxes-container5"></div>
				        <input type="button" name="add_button1" value="Add" onclick="addTextbox5()" />
				    </div>
				</td>
				<td colspan="2">
				    <div>
				    	<h5>Additional Indicators</h5>
				    	<input type="hidden" name="num_textboxes6" value="0" />
				    </div>
				    
				    <div style="padding-left: 18px;">
				        <div id="textboxes-container6"></div>
				        <input type="button" name="add_button1" value="Add" onclick="addTextbox6()" />
				    </div>
				</td>
			</tr>
		</table>
		<br>
		<h4><b>Select Scenario</b></h4>
		<div>
			<table>
			    <tr>
			        <td colspan="4">
			            <input type='radio' id='opt_criteria1' name='opt_crit' value='opt_criteria1' checked>
			            <label for='opt_criteria1'><b>No Scenario</b></label>
			        </td>
			    </tr>
			    <tr>
			        <td style="width: 235px; ">
			            <input type='radio' id='opt_criteria2' name='opt_crit' value='opt_criteria2'>
			            <label for='opt_criteria2'><b>Scenario Parameters</b></label>
			        </td>
			        <td style="width: 275px; padding-left: 18px;">
                        <label><b>Setting: </b></label><br>
                        <select id="settingSelect" disabled style="width:230px;">
                            <option value="A1">Urban Area</option>
                            <option value="A2">Suburban Area</option>
                            <option value="A3">Rural Area</option>
                        </select>
                    </td>
                    <td style="width: 235px; padding-left: 18px;">
                        <label><b>Land Availability: </b></label><br>
                        <select id="landSelect" disabled style="width:190px;">
                            <option value="B1">Low</option>
                            <option value="B2">Medium</option>
                            <option value="B3">High</option>
                        </select>
                    </td>
                    <td style="width: 325px; padding-left: 18px;">
                        <label><b>End use: </b></label><br>
                        <select id="enduseSelect" disabled style="width:280px;">
                            <option value="C1">To surface water body</option>
                            <option value="C2">For Irrigation/gardening</option>
                            <option value="C3">For Toilet Flushing</option>
                            <option value="C4">For High End/Industrial Use</option>
                        </select>
                    
			        </td>
			    </tr>
			</table>
		</div>
		<br>
		<h4><b>Select Technologies</b></h4>
		<table>
			<tr style="vertical-align: top">
				<td style="width: 300px;">
				    <div>
				    	<h5>Mechanized Treatment</h5>
				        <input type="checkbox" name="tech[]" value="ASP">Activated Sludge Process<br/>
				        <input type="checkbox" name="tech[]" value="RBC">Rotating Biological Contactors<br/>
				        <input type="checkbox" name="tech[]" value="MBR">Membrane Bio-Reactor<br/>
				        <input type="checkbox" name="tech[]" value="MBBR">Moving Bed Bio-Reactor<br/>
				        <input type="checkbox" name="tech[]" value="SBR">Sequencing Batch Reactor<br/>
				        <input type="checkbox" name="tech[]" value="Ext_aeration">Extended Aeration<br/>
				    </div>
				</td>
				<td style="width: 445px;">
				    <div>
				    	<h5>Natural Treatment</h5>
				        <input type="checkbox" name="tech[]" value="CW_SFV">Constructed Wetlands (Surface flow vertical)<br/>
				        <input type="checkbox" name="tech[]" value="CW_SSFH">Constructed Wetlands (Subsurface flow horizontal)<br/>
				        <input type="checkbox" name="tech[]" value="CW_DPW">Constructed Wetlands (Deep bed wetlands)<br/>
				        <input type="checkbox" name="tech[]" value="WS_ponds">Waste Stabilization ponds<br/>
				        <input type="checkbox" name="tech[]" value="D_ponds">Duckweed ponds<br/>
				        <input type="hidden" name="num_technologies" value="0" />
				    </div>
				</td>
				<td style="width: 325px;">
					<h5>Add Technology</h5>
				    <div style="padding-left: 18px;">
				    	<div id="technology-container"></div>
				        <input type="button" name="add_tech_button" value="Add" onclick="addTechnology()" />
				    </div>
				</td>
			</tr>
		</table>
	    <br>
	    <table>
	    	<td style="border:none; width:1070px;">
	    		<center>
				    <div>
				        <input type="submit" name="submit_xx" value="Submit" style="width:200px;"/>
				    </div>
			    </center>
			</td>
		</table>
		<br>
		<p>Note: Please read the instructions before proceeding with the use of this tool.</p>
	    <div>
	    	<pre id="grid-container"></pre>
	    </div>
	    <div>
            <input type="submit" id="submitNeoButton" name="submit_neo" value="Generate Technology Assessment Report" />
        </div>
        <br>
        <pre id="newmat" style="font-size: 24px;"></pre>
    </form>

    <script>
    	function addTextbox() {
        	var gridContainer = document.getElementById('grid-container');
		    gridContainer.innerHTML = ''; // Clear previous grid
		    document.getElementById('submitNeoButton').style.display = 'none'; 
		    var form = document.querySelector('form');
		    var numTextboxes = form.elements['num_textboxes'].value;
		    var textboxesContainer = document.getElementById('textboxes-container');
		    var newTextbox = document.createElement('input');
		    newTextbox.type = 'text';
		    newTextbox.name = 'textbox[]';
		    newTextbox.value = '1.' + (parseInt(numTextboxes) + 1) +' ';
		    newTextbox.style.display = 'block'; // Display the new textbox on a new line
		    newTextbox.style.width = '190px';
		    newTextbox.style.textAlign = 'left';
		    textboxesContainer.appendChild(newTextbox);
		    form.elements['num_textboxes'].value = parseInt(numTextboxes) + 1;
		}
		function addTextbox1() {
        	var gridContainer = document.getElementById('grid-container');
		    gridContainer.innerHTML = ''; // Clear previous grid
		    document.getElementById('submitNeoButton').style.display = 'none'; 
		    var form = document.querySelector('form');
		    var numTextboxes = form.elements['num_textboxes1'].value;
		    var textboxesContainer = document.getElementById('textboxes-container1');
		    var newTextbox = document.createElement('input');
		    newTextbox.type = 'text';
		    newTextbox.name = 'textbox[]';
		    newTextbox.value = '2.' + (parseInt(numTextboxes) + 1) + ' ';
		    newTextbox.style.display = 'block'; // Display the new textbox on a new line
		    newTextbox.style.width = '230px';
		    newTextbox.style.textAlign = 'left';
		    textboxesContainer.appendChild(newTextbox);
		    form.elements['num_textboxes1'].value = parseInt(numTextboxes) + 1;
		}
		function addTextbox2() {
        	var gridContainer = document.getElementById('grid-container');
		    gridContainer.innerHTML = ''; // Clear previous grid
		    document.getElementById('submitNeoButton').style.display = 'none'; 
		    var form = document.querySelector('form');
		    var numTextboxes = form.elements['num_textboxes2'].value;
		    var textboxesContainer = document.getElementById('textboxes-container2');
		    var newTextbox = document.createElement('input');
		    newTextbox.type = 'text';
		    newTextbox.name = 'textbox[]';
		    newTextbox.value = '3.' + (parseInt(numTextboxes) + 1) + ' ';
		    newTextbox.style.display = 'block'; // Display the new textbox on a new line
		    newTextbox.style.width = '280px';
		    newTextbox.style.textAlign = 'left';
		    textboxesContainer.appendChild(newTextbox);
		    form.elements['num_textboxes2'].value = parseInt(numTextboxes) + 1;
		}
		function addTextbox3() {
        	var gridContainer = document.getElementById('grid-container');
		    gridContainer.innerHTML = ''; // Clear previous grid
		    document.getElementById('submitNeoButton').style.display = 'none'; 
		    var form = document.querySelector('form');
		    var numTextboxes = form.elements['num_textboxes3'].value;
		    var textboxesContainer = document.getElementById('textboxes-container3');
		    var newTextbox = document.createElement('input');
		    newTextbox.type = 'text';
		    newTextbox.name = 'textbox[]';
		    newTextbox.value = '4.' + (parseInt(numTextboxes) + 1) + ' ';
		    newTextbox.style.display = 'block'; // Display the new textbox on a new line
		    newTextbox.style.width = '190px';
		    newTextbox.style.textAlign = 'left';
		    textboxesContainer.appendChild(newTextbox);
		    form.elements['num_textboxes3'].value = parseInt(numTextboxes) + 1;
		}
		function addTextbox4() {
        	var gridContainer = document.getElementById('grid-container');
		    gridContainer.innerHTML = ''; // Clear previous grid
		    document.getElementById('submitNeoButton').style.display = 'none'; 
		    var form = document.querySelector('form');
		    var numTextboxes = form.elements['num_textboxes4'].value;
		    var textboxesContainer = document.getElementById('textboxes-container4');
		    var newTextbox = document.createElement('input');
		    newTextbox.type = 'text';
		    newTextbox.name = 'textbox[]';
		    newTextbox.value = '5.' + (parseInt(numTextboxes) + 1) + ' ';
		    newTextbox.style.display = 'block'; // Display the new textbox on a new line
		    newTextbox.style.width = '190px';
		    newTextbox.style.textAlign = 'left';
		    textboxesContainer.appendChild(newTextbox);
		    form.elements['num_textboxes4'].value = parseInt(numTextboxes) + 1;
		}
		function addTextbox5() {
        	var gridContainer = document.getElementById('grid-container');
		    gridContainer.innerHTML = ''; // Clear previous grid
		    document.getElementById('submitNeoButton').style.display = 'none'; 
		    var form = document.querySelector('form');
		    var numTextboxes = form.elements['num_textboxes5'].value;
		    var textboxesContainer = document.getElementById('textboxes-container5');
		    var newTextbox = document.createElement('input');
		    newTextbox.type = 'text';
		    newTextbox.name = 'textbox[]';
		    newTextbox.value = '6.' + (parseInt(numTextboxes) + 1) + ' ';
		    newTextbox.style.display = 'block'; // Display the new textbox on a new line
		    newTextbox.style.width = '230px';
		    newTextbox.style.textAlign = 'left';
		    textboxesContainer.appendChild(newTextbox);
		    form.elements['num_textboxes5'].value = parseInt(numTextboxes) + 1;
		}
		function addTextbox6() {
        	var gridContainer = document.getElementById('grid-container');
		    gridContainer.innerHTML = ''; // Clear previous grid
		    document.getElementById('submitNeoButton').style.display = 'none'; 
		    var form = document.querySelector('form');
		    var numTextboxes = form.elements['num_textboxes6'].value;
		    var textboxesContainer = document.getElementById('textboxes-container6');
		    var newTextbox = document.createElement('input');
		    newTextbox.type = 'text';
		    newTextbox.name = 'textbox[]';
		    newTextbox.value = '7.' + (parseInt(numTextboxes) + 1) + ' ';
		    newTextbox.style.display = 'block'; // Display the new textbox on a new line
		    newTextbox.style.width = '300px';
		    newTextbox.style.textAlign = 'left';
		    textboxesContainer.appendChild(newTextbox);
		    form.elements['num_textboxes6'].value = parseInt(numTextboxes) + 1;
		}
		function addTechnology() {
			var gridContainer = document.getElementById('grid-container');
		    gridContainer.innerHTML = ''; // Clear previous grid
		    document.getElementById('submitNeoButton').style.display = 'none'; 
		    var form = document.querySelector('form');
		    var numTechboxes = form.elements['num_technologies'].value;
		    var techboxesContainer = document.getElementById('technology-container');
		    var newTextbox = document.createElement('input');
		    newTextbox.type = 'text';
		    newTextbox.name = 'techbox[]';
		    newTextbox.value = 'Tech ' + (parseInt(numTechboxes) + 1) + ' ';
		    newTextbox.style.display = 'block'; // Display the new textbox on a new line
		    newTextbox.style.width = '280px';
		    newTextbox.style.textAlign = 'left';
		    techboxesContainer.appendChild(newTextbox);
		    form.elements['num_technologies'].value = parseInt(numTechboxes) + 1;
		}

        document.querySelector('form').addEventListener('submit', function(event) {
    		event.preventDefault();

    		var gridContainer = document.getElementById('grid-container');
		    gridContainer.innerHTML = ''; // Clear previous grid
		    

		    var textboxValues = Array.from(document.querySelectorAll('input[name="textbox[]"]')).map(function(textbox) {
		        return textbox.value;
		    });

		    var selectedIndicators = Array.from(document.querySelectorAll('input[name="indicate[]"]:checked')).map(function(indicator) {
		        return indicator.value;
		    });

		    var techboxValues = Array.from(document.querySelectorAll('input[name="techbox[]"]')).map(function(techbox) {
		        return techbox.value;
		    });

		    var selectedTechs = Array.from(document.querySelectorAll('input[name="tech[]"]:checked')).map(function(tech) {
		        return tech.value;
		    });
			
			var list_indicators = {
				Capex: ['Capital Cost'],
				Opex: ['Operational Cost'],
				Revenue: ['Revenue Cost'],
				LCC: ['Life Cycle Cost'],
				GWP: ['Global Warming Potential'],
				EuP: ['Eutrophication Potential'],
				EcoSer: ['Ecosystem Services'],
				WasRec: ['Wastewater recycling'],
				EnePot: ['Energy'],
				ProPot: ['Products (fertilizers, sludge etc)'],
				SocUnskill: ['Unskilled manpower'],
				SocAccept: ['Acceptability'],
				SocPart: ['Participation'],
				R_reli: ['Reliability'],
				R_dura: ['Durability'],
				R_flex: ['Flexibility'],
				R_repl: ['Replicability'],
				BOD: ['Biochemical Oxygen Demand'],
				COD: ['Chemical Oxygen Demand'],
				Nitro: ['Total Kjeldahl Nitrogen'],
				Phosph: ['Phosphorus'],
				Em_cont: ['Emerging Contaminants'],
				Lan_suit: ['Land Suitability']
			}
			var list_technology = {
				ASP: ['Activated Sludge Process'],
				RBC: ['Rotating Biological Contactors'],
				MBR: ['Membrane Bio-Reactor'],
				MBBR: ['Moving Bed Bio-Reactor'],
				SBR: ['Sequencing Batch Reactor'],
				Ext_aeration: ['Extended Aeration'],
				CW_SFV: ['Constructed Wetlands (Surface flow vertical)'],
				CW_SSFH: ['Constructed Wetlands (Subsurface flow horizontal)'],
				CW_DPW: ['Constructed Wetlands (Deep bed wetlands)'],
				WS_ponds: ['Waste Stabilization ponds'],
				D_ponds: ['Duckweed ponds']
			}
		    var matrixValues = {
		        ASP: [],
		        RBC: [],
		        MBR: [],
		        MBBR: [],
		        SBR: [],
		        Ext_aeration: [],
		        CW_SFV: [],
		        CW_SSFH: [],
		        CW_DPW: [],
		        WS_ponds: [],
		        D_ponds: []
		    };

		    for (var j = 0; j < selectedIndicators.length; j++) {
		        var indicator = selectedIndicators[j];
		        var values = [];

		        if (indicator === "Capex") {
		            values = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
		        } else if (indicator === "Opex") {
		            values = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
		        } else if (indicator === "Revenue") {
		            values = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
		        } else if (indicator === "LCC") {
		            values = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
		        } else if (indicator === "GWP") {
		            values = [1, 2, 3, 4, 252, 253, 254, 255, 256, 257, 258];
		        } else if (indicator === "EuP") {
		            values = [40, 50, 60, 90, 2000, 3000, 4000, 5000, 6000, 7000, 8000];
		        } else if (indicator === "EcoSer") {
		            values = [80, 50, 70, 20, 2001, 3001, 4001, 5001, 6001, 7001, 8001];
		        } else if (indicator === "WasRec") {
		            values = [80, 50, 66, 101, 201, 301, 401, 501, 601, 701, 801];
		        } else if (indicator === "EnePot") {
		            values = [80, 50, 66, 1001, 2001, 3001, 4001, 5001, 6001, 7001, 8001];
		        } else if (indicator === "ProPot") {
		            values = [80, 50, 66, 11, 21, 31, 41, 51, 61, 71, 81];
		        } else if (indicator === "SocUnskill") {
		            values = [401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411];
		        } else if (indicator === "SocAccept") {
		            values = [1401, 1402, 1403, 1404, 1405, 1406, 1407, 1408, 1409, 1410, 1411];
		        } else if (indicator === "SocPart") {
		            values = [2401, 2402, 2403, 2404, 2405, 2406, 2407, 2408, 2409, 2410, 2411];
		        } else if (indicator === "R_reli") {
		            values = [5101, 5102, 5103, 5104, 5105, 5106, 5107, 5108, 5109, 5110, 5111];
		        } else if (indicator === "R_dura") {
		            values = [5201, 5202, 5203, 5204, 5205, 5206, 5207, 5208, 5209, 5210, 5211];
		        } else if (indicator === "R_flex") {
		            values = [5301, 5302, 5303, 5304, 5305, 5306, 5307, 5308, 5309, 5310, 5311];
		        } else if (indicator === "R_repl") {
		            values = [5401, 5402, 5403, 5404, 5405, 5406, 5407, 5408, 5409, 5410, 5411];
		        } else if (indicator === "BOD") {
		            values = [6101, 6102, 6103, 6104, 6105, 6106, 6107, 6108, 6109, 6110, 6111];
		        } else if (indicator === "COD") {
		            values = [6201, 6202, 6203, 6204, 6205, 6206, 6207, 6208, 6209, 6210, 6211];
		        } else if (indicator === "Nitro") {
		            values = [6301, 6302, 6303, 6304, 6305, 6306, 6307, 6308, 6309, 6310, 6311];
		        } else if (indicator === "Phosph") {
		            values = [6401, 6402, 6403, 6404, 6405, 6406, 6407, 6408, 6409, 6410, 6411];
		        } else if (indicator === "Em_cont") {
		            values = [6501, 6502, 6503, 6504, 6505, 6506, 6507, 6508, 6509, 6510, 6511];
		        } else if (indicator === "Lan_suit") {
		            values = [6601, 6602, 6603, 6604, 6605, 6606, 6607, 6608, 6609, 6610, 6611];
		        } 

		        matrixValues.ASP.push(values[0]);
		        matrixValues.RBC.push(values[1]);
		        matrixValues.MBR.push(values[2]);
		        matrixValues.MBBR.push(values[3]);
		        matrixValues.SBR.push(values[4]);
		        matrixValues.Ext_aeration.push(values[5]);
		        matrixValues.CW_SFV.push(values[6]);
		        matrixValues.CW_SSFH.push(values[7]);
		        matrixValues.CW_DPW.push(values[8]);
		        matrixValues.WS_ponds.push(values[9]);
		        matrixValues.D_ponds.push(values[10]);
		    }
		    //--------------------------------------------------------------------------------
		    var wtmat = {
			    A0B0C0: [],
				A1B1C1: [],
				A1B1C2: [],
				A1B1C3: [],
				A1B1C4: [],
				A1B2C1: [],
				A1B2C2: [],
				A1B2C3: [],
				A1B2C4: [],
				A1B3C1: [],
				A1B3C2: [],
				A1B3C3: [],
				A1B3C4: [],
				A2B1C1: [],
				A2B1C2: [],
				A2B1C3: [],
				A2B1C4: [],
				A2B2C1: [],
				A2B2C2: [],
				A2B2C3: [],
				A2B2C4: [],
				A2B3C1: [],
				A2B3C2: [],
				A2B3C3: [],
				A2B3C4: [],
				A3B1C1: [],
				A3B1C2: [],
				A3B1C3: [],
				A3B1C4: [],
				A3B2C1: [],
				A3B2C2: [],
				A3B2C3: [],
				A3B2C4: [],
				A3B3C1: [],
				A3B3C2: [],
				A3B3C3: [],
				A3B3C4: []
			};

			for (var j = 0; j < selectedIndicators.length; j++) {
		        var indicator = selectedIndicators[j];
		        var values = [];

		        if (indicator === "Capex") {
		            values = [10, 30, 60, 80, 40, 40, 40, 20, 90, 40, 30, 60, 60, 30, 50, 50, 90, 50, 60, 50, 10, 80, 30, 50, 40, 10, 80, 40, 20, 70, 90, 60, 90, 30, 30, 70, 60];
		        } else if (indicator === "Opex") {
		            values = [10, 70, 30, 50, 40, 40, 90, 90, 10, 80, 20, 30, 90, 40, 40, 50, 90, 30, 10, 80, 50, 90, 70, 30, 60, 30, 60, 80, 10, 20, 50, 20, 90, 60, 80, 70, 70];
		        } else if (indicator === "Revenue") {
		            values = [10, 80, 40, 20, 40, 60, 50, 60, 70, 90, 40, 80, 70, 90, 40, 50, 80, 90, 90, 50, 40, 60, 90, 50, 10, 20, 60, 10, 80, 10, 20, 40, 20, 40, 70, 50, 80];
		        } else if (indicator === "LCC") {
		            values = [10, 20, 30, 10, 60, 50, 10, 90, 20, 20, 50, 40, 30, 80, 60, 40, 10, 50, 30, 70, 90, 20, 60, 30, 70, 30, 60, 50, 70, 50, 80, 20, 90, 60, 70, 80, 40];
		        } else if (indicator === "GWP") {
		            values = [10, 50, 40, 30, 90, 90, 10, 80, 90, 80, 70, 10, 70, 50, 80, 40, 20, 10, 70, 20, 70, 50, 60, 60, 60, 20, 10, 20, 90, 50, 20, 40, 30, 30, 90, 80, 50];
		        } else if (indicator === "EuP") {
		            values = [30, 80, 60, 10, 80, 90, 10, 80, 30, 60, 80, 20, 40, 30, 50, 40, 40, 70, 30, 30, 60, 80, 40, 10, 40, 30, 90, 40, 30, 20, 50, 80, 40, 80, 30, 70, 60];
		        } else if (indicator === "EcoSer") {
		            values = [40, 80, 80, 50, 90, 60, 40, 90, 60, 60, 50, 60, 80, 70, 10, 40, 10, 50, 70, 10, 60, 70, 50, 60, 50, 90, 40, 60, 50, 90, 80, 50, 30, 20, 40, 10, 70];
		        } else if (indicator === "WasRec") {
		            values = [10, 80, 60, 60, 70, 70, 30, 20, 70, 70, 50, 80, 20, 70, 70, 30, 60, 80, 30, 30, 70, 40, 60, 50, 20, 40, 60, 30, 50, 40, 20, 50, 30, 50, 40, 40, 50];
		        } else if (indicator === "EnePot") {
		            values = [10, 60, 20, 40, 50, 80, 70, 60, 40, 30, 10, 40, 40, 70, 20, 10, 80, 40, 70, 60, 40, 20, 30, 20, 50, 20, 30, 20, 80, 50, 60, 40, 70, 10, 60, 40, 20];
		        } else if (indicator === "ProPot") {
		            values = [10, 30, 60, 60, 30, 30, 60, 60, 50, 20, 60, 30, 80, 60, 60, 20, 30, 70, 70, 30, 70, 20, 30, 20, 10, 80, 30, 70, 40, 20, 50, 80, 10, 30, 10, 70, 20];
		        } else if (indicator === "SocUnskill") {
		            values = [10, 20, 40, 50, 30, 10, 10, 40, 20, 30, 70, 40, 80, 80, 70, 40, 20, 30, 60, 50, 30, 80, 10, 50, 60, 50, 50, 10, 60, 80, 20, 60, 80, 10, 20, 50, 80];
		        } else if (indicator === "SocAccept") {
		            values = [10, 20, 70, 80, 30, 30, 50, 70, 80, 60, 10, 50, 60, 50, 40, 10, 80, 50, 10, 60, 30, 80, 20, 20, 30, 80, 80, 30, 20, 10, 40, 10, 20, 70, 30, 20, 20];
		        } else if (indicator === "SocPart") {
		            values = [10, 10, 10, 40, 50, 30, 20, 60, 30, 20, 40, 40, 80, 20, 80, 30, 50, 80, 20, 40, 20, 70, 60, 10, 10, 30, 50, 60, 70, 30, 50, 40, 70, 50, 30, 50, 10];
		        } else if (indicator === "R_reli") {
		            values = [10, 60, 40, 40, 20, 60, 10, 10, 80, 50, 40, 70, 50, 30, 50, 60, 50, 80, 60, 80, 60, 10, 60, 70, 30, 60, 30, 20, 10, 70, 10, 10, 50, 80, 70, 50, 60];
		        } else if (indicator === "R_dura") {
		            values = [10, 10, 20, 80, 10, 30, 50, 30, 10, 70, 10, 40, 70, 30, 70, 40, 80, 40, 60, 70, 60, 80, 30, 60, 70, 60, 30, 10, 70, 70, 50, 50, 80, 20, 40, 60, 10];
		        } else if (indicator === "R_flex") {
		            values = [10, 60, 50, 20, 30, 20, 70, 60, 20, 60, 20, 60, 30, 40, 30, 10, 10, 70, 10, 50, 50, 10, 10, 50, 50, 40, 60, 60, 70, 70, 50, 30, 40, 80, 20, 20, 70];
		        } else if (indicator === "R_repl") {
		            values = [10, 20, 30, 60, 50, 20, 10, 80, 50, 70, 70, 20, 10, 10, 50, 40, 10, 40, 80, 40, 80, 50, 10, 40, 60, 40, 80, 20, 30, 50, 80, 70, 80, 80, 10, 80, 70];
		        } else if (indicator === "BOD") {
		            values = [10, 60, 50, 40, 10, 70, 70, 20, 70, 60, 10, 10, 60, 70, 20, 60, 80, 20, 70, 60, 10, 60, 70, 60, 80, 80, 20, 40, 50, 10, 60, 60, 60, 40, 80, 10, 50];
		        } else if (indicator === "COD") {
		            values = [10, 60, 10, 50, 10, 50, 50, 30, 10, 50, 20, 80, 40, 40, 50, 40, 70, 10, 10, 20, 70, 70, 20, 30, 40, 40, 80, 40, 80, 40, 10, 30, 30, 20, 80, 20, 20];
		        } else if (indicator === "Nitro") {
		            values = [10, 30, 50, 60, 10, 40, 40, 10, 40, 10, 60, 60, 20, 10, 20, 30, 50, 50, 30, 40, 50, 60, 30, 10, 70, 30, 60, 20, 20, 10, 60, 30, 30, 70, 30, 30, 70];
		        } else if (indicator === "Phosph") {
		            values = [10, 30, 10, 10, 70, 60, 10, 70, 40, 60, 20, 40, 50, 40, 20, 70, 40, 50, 50, 10, 50, 80, 10, 50, 40, 30, 70, 80, 50, 30, 60, 40, 50, 80, 70, 70, 20];
		        } else if (indicator === "Em_cont") {
		            values = [10, 10, 60, 40, 10, 60, 10, 60, 80, 10, 10, 10, 60, 80, 80, 10, 70, 60, 80, 30, 10, 70, 40, 60, 40, 40, 50, 80, 60, 40, 70, 10, 10, 20, 50, 20, 30];
		        } else if (indicator === "Lan_suit") {
		            values = [10, 70, 80, 70, 10, 20, 40, 70, 30, 10, 60, 70, 80, 50, 70, 70, 70, 60, 40, 20, 10, 50, 70, 30, 80, 70, 10, 20, 50, 50, 80, 20, 10, 80, 20, 40, 30];
		        } 

		        wtmat.A0B0C0.push(values[0]);
				wtmat.A1B1C1.push(values[1]);
				wtmat.A1B1C2.push(values[2]);
				wtmat.A1B1C3.push(values[3]);
				wtmat.A1B1C4.push(values[4]);
				wtmat.A1B2C1.push(values[5]);
				wtmat.A1B2C2.push(values[6]);
				wtmat.A1B2C3.push(values[7]);
				wtmat.A1B2C4.push(values[8]);
				wtmat.A1B3C1.push(values[9]);
				wtmat.A1B3C2.push(values[10]);
				wtmat.A1B3C3.push(values[11]);
				wtmat.A1B3C4.push(values[12]);
				wtmat.A2B1C1.push(values[13]);
				wtmat.A2B1C2.push(values[14]);
				wtmat.A2B1C3.push(values[15]);
				wtmat.A2B1C4.push(values[16]);
				wtmat.A2B2C1.push(values[17]);
				wtmat.A2B2C2.push(values[18]);
				wtmat.A2B2C3.push(values[19]);
				wtmat.A2B2C4.push(values[20]);
				wtmat.A2B3C1.push(values[21]);
				wtmat.A2B3C2.push(values[22]);
				wtmat.A2B3C3.push(values[23]);
				wtmat.A2B3C4.push(values[24]);
				wtmat.A3B1C1.push(values[25]);
				wtmat.A3B1C2.push(values[26]);
				wtmat.A3B1C3.push(values[27]);
				wtmat.A3B1C4.push(values[28]);
				wtmat.A3B2C1.push(values[29]);
				wtmat.A3B2C2.push(values[30]);
				wtmat.A3B2C3.push(values[31]);
				wtmat.A3B2C4.push(values[32]);
				wtmat.A3B3C1.push(values[33]);
				wtmat.A3B3C2.push(values[34]);
				wtmat.A3B3C3.push(values[35]);
				wtmat.A3B3C4.push(values[36]);
		    }
		    //------------------------------------------------------------------------
		    var cbmat = {
			    A0B0C0: [],
				A1B1C1: [],
				A1B1C2: [],
				A1B1C3: [],
				A1B1C4: [],
				A1B2C1: [],
				A1B2C2: [],
				A1B2C3: [],
				A1B2C4: [],
				A1B3C1: [],
				A1B3C2: [],
				A1B3C3: [],
				A1B3C4: [],
				A2B1C1: [],
				A2B1C2: [],
				A2B1C3: [],
				A2B1C4: [],
				A2B2C1: [],
				A2B2C2: [],
				A2B2C3: [],
				A2B2C4: [],
				A2B3C1: [],
				A2B3C2: [],
				A2B3C3: [],
				A2B3C4: [],
				A3B1C1: [],
				A3B1C2: [],
				A3B1C3: [],
				A3B1C4: [],
				A3B2C1: [],
				A3B2C2: [],
				A3B2C3: [],
				A3B2C4: [],
				A3B3C1: [],
				A3B3C2: [],
				A3B3C3: [],
				A3B3C4: []
			};

			for (var j = 0; j < selectedIndicators.length; j++) {
		        var indicator = selectedIndicators[j];
		        var values = [];

		        if (indicator === "Capex") {
		            values = [0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0];
		        } else if (indicator === "Opex") {
		            values = [0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1];
		        } else if (indicator === "Revenue") {
		            values = [0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1];
		        } else if (indicator === "LCC") {
		            values = [0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0];
		        } else if (indicator === "GWP") {
		            values = [1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1];
		        } else if (indicator === "EuP") {
		            values = [0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0];
		        } else if (indicator === "EcoSer") {
		            values = [0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0];
		        } else if (indicator === "WasRec") {
		            values = [0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1];
		        } else if (indicator === "EnePot") {
		            values = [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0];
		        } else if (indicator === "ProPot") {
		            values = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0];
		        } else if (indicator === "SocUnskill") {
		            values = [0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1];
		        } else if (indicator === "SocAccept") {
		            values = [0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0];
		        } else if (indicator === "SocPart") {
		            values = [0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0];
		        } else if (indicator === "R_reli") {
		            values = [0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0];
		        } else if (indicator === "R_dura") {
		            values = [0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0];
		        } else if (indicator === "R_flex") {
		            values = [0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0];
		        } else if (indicator === "R_repl") {
		            values = [0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0];
		        } else if (indicator === "BOD") {
		            values = [0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0];
		        } else if (indicator === "COD") {
		            values = [0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0];
		        } else if (indicator === "Nitro") {
		            values = [0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0];
		        } else if (indicator === "Phosph") {
		            values = [0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1];
		        } else if (indicator === "Em_cont") {
		            values = [0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1];
		        } else if (indicator === "Lan_suit") {
		            values = [0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1];
		        } 

		        cbmat.A0B0C0.push(values[0]);
				cbmat.A1B1C1.push(values[1]);
				cbmat.A1B1C2.push(values[2]);
				cbmat.A1B1C3.push(values[3]);
				cbmat.A1B1C4.push(values[4]);
				cbmat.A1B2C1.push(values[5]);
				cbmat.A1B2C2.push(values[6]);
				cbmat.A1B2C3.push(values[7]);
				cbmat.A1B2C4.push(values[8]);
				cbmat.A1B3C1.push(values[9]);
				cbmat.A1B3C2.push(values[10]);
				cbmat.A1B3C3.push(values[11]);
				cbmat.A1B3C4.push(values[12]);
				cbmat.A2B1C1.push(values[13]);
				cbmat.A2B1C2.push(values[14]);
				cbmat.A2B1C3.push(values[15]);
				cbmat.A2B1C4.push(values[16]);
				cbmat.A2B2C1.push(values[17]);
				cbmat.A2B2C2.push(values[18]);
				cbmat.A2B2C3.push(values[19]);
				cbmat.A2B2C4.push(values[20]);
				cbmat.A2B3C1.push(values[21]);
				cbmat.A2B3C2.push(values[22]);
				cbmat.A2B3C3.push(values[23]);
				cbmat.A2B3C4.push(values[24]);
				cbmat.A3B1C1.push(values[25]);
				cbmat.A3B1C2.push(values[26]);
				cbmat.A3B1C3.push(values[27]);
				cbmat.A3B1C4.push(values[28]);
				cbmat.A3B2C1.push(values[29]);
				cbmat.A3B2C2.push(values[30]);
				cbmat.A3B2C3.push(values[31]);
				cbmat.A3B2C4.push(values[32]);
				cbmat.A3B3C1.push(values[33]);
				cbmat.A3B3C2.push(values[34]);
				cbmat.A3B3C3.push(values[35]);
				cbmat.A3B3C4.push(values[36]);
		    }
		   	/*var outputElement = document.getElementById("tempmat");
		    outputElement.innerHTML = JSON.stringify(selectedTechs, null, 2);*/
		    //-----------------------------------------------------------------Criteria-------
		    const noCriteriaRadio = document.getElementById('opt_criteria1');
			const settingSelect = document.getElementById('settingSelect');
			const landSelect = document.getElementById('landSelect');
			const enduseSelect = document.getElementById('enduseSelect');

			if (noCriteriaRadio.checked) {
				//output.textContent = 'A0B0C0';
				var selectedScenario = 'A0B0C0';
			} else {
			    const settingValue = settingSelect.value;
			    const landValue = landSelect.value;
			    const enduseValue = enduseSelect.value;
			    //output.textContent = `${settingValue}${landValue}${enduseValue}`;
			    var selectedScenario = `${settingValue}${landValue}${enduseValue}`;
			}
    		
			//------------------------------------------------------------------------



		    var table = document.createElement('table');
		    var headerRow = document.createElement('tr');

		    var row;
		    row=0;
		    // Create header row with indicator names
		    var indicatorHeaders = document.createElement('th');
		    var valueInput =document.createElement('input');
		    valueInput.type = 'textbox';
		    valueInput.value = 'Indicators';
		    valueInput.name = 'fmatrix[' + row + '][]';
		    valueInput.style.width = '100px';
		    valueInput.disabled=true;
		    indicatorHeaders.appendChild(valueInput);
		    headerRow.appendChild(indicatorHeaders);

		    for (var k = 0; k < selectedIndicators.length; k++) {
		        var indicatorHeader = document.createElement('th');
		        var valueInput = document.createElement('input');
		        valueInput.type = 'textbox';
		        valueInput.value = list_indicators[selectedIndicators[k]][0];
		        valueInput.name = 'fmatrix[' + row + '][]';
		        valueInput.style.width = '75px';
		        valueInput.disabled=true;
		        indicatorHeader.appendChild(valueInput);
		        headerRow.appendChild(indicatorHeader);
		    }

		    // Create header columns for the textboxes
		    for (var l = 0; l < textboxValues.length; l++) {
		        var textboxHeader = document.createElement('th');
		        var valueInput = document.createElement('input');
		        valueInput.type='textbox';
		        valueInput.value = textboxValues[l];
		        valueInput.name = 'fmatrix[' + row + '][]';
		        valueInput.style.width = '75px';
		        valueInput.disabled=true;
		        textboxHeader.appendChild(valueInput);
		        headerRow.appendChild(textboxHeader);
		    }

		    table.appendChild(headerRow);

		    // Create rows for each tech and populate values
		    for (var m = 0; m < selectedTechs.length; m++) {
		    	row=row+1;
		        var techRow = document.createElement('tr');
		        var techCell = document.createElement('td');
		        var valueInput = document.createElement('input');
		        valueInput.type='textbox';
		        valueInput.value = list_technology[selectedTechs[m]][0];
		        valueInput.name = 'fmatrix[' + row + '][]';
		        valueInput.style.width = '100px';
		        valueInput.disabled=true;
		        techCell.appendChild(valueInput);
		        techRow.appendChild(techCell);

		        for (var n = 0; n < selectedIndicators.length; n++) {
		            var valueCell = document.createElement('td');
		            var valueInput = document.createElement('input');
		            valueInput.type = 'number';
		            valueInput.value = matrixValues[selectedTechs[m]][n];
		            valueInput.name = 'fmatrix[' + row + '][]';
		        	valueInput.style.width = '75px';
		            valueCell.appendChild(valueInput);
		            techRow.appendChild(valueCell);
		        }

		        // Add cells for the textboxes
		        for (var p = 0; p < textboxValues.length; p++) {
		            var textboxCell = document.createElement('td');
		            var textboxInput = document.createElement('input');
		            textboxInput.type = 'number';
		            textboxInput.value = '0';
		            textboxInput.name = 'fmatrix[' + row + '][]';
		            textboxInput.style.width = '75px';
		            textboxCell.appendChild(textboxInput);
		            techRow.appendChild(textboxCell);
		        }

		        table.appendChild(techRow);
		    }

		    for (var m = 0; m < techboxValues.length; m++) {
		    	row=row+1;
		        var techRow = document.createElement('tr');
		        var techCell = document.createElement('td');
		        var valueInput = document.createElement('input');
		        valueInput.type = 'textbox';
		        valueInput.value = techboxValues[m];
		        valueInput.name = 'fmatrix[' + row + '][]';
		        valueInput.style.width = '100px';
		        valueInput.disabled = true;
		        techCell.appendChild(valueInput);
		        techRow.appendChild(techCell);

		        for (var n = 0; n < selectedIndicators.length; n++) {
		            var valueCell = document.createElement('td');
		            var valueInput = document.createElement('input');
		            valueInput.type = 'number';
		            valueInput.value = '0';
		            valueInput.name = 'fmatrix[' + row + '][]';
		        	valueInput.style.width = '75px';
		            valueCell.appendChild(valueInput);
		            techRow.appendChild(valueCell);
		        }

		        // Add cells for the textboxes
		        for (var p = 0; p < textboxValues.length; p++) {
		            var textboxCell = document.createElement('td');
		            var textboxInput = document.createElement('input');
		            textboxInput.type = 'number';
		            textboxInput.value = '0';
		            textboxInput.name = 'fmatrix[' + row + '][]';
		            textboxInput.style.width = '75px';
		            textboxCell.appendChild(textboxInput);
		            techRow.appendChild(textboxCell);
		        }

		        table.appendChild(techRow);
		    }
		    for (var m = 0; m < 1; m++) {
		    	row=row+1;
		        var techRow = document.createElement('tr');
		        var techCell = document.createElement('td');
		        var valueInput = document.createElement('input');
		        valueInput.type = 'textbox';
		        valueInput.value = 'Weights';
		        valueInput.name = 'fmatrix[' + row + '][]';
		        valueInput.style.width = '100px';
		        valueInput.disabled = true;
		        techCell.appendChild(valueInput);
		        techRow.appendChild(techCell);

		        for (var n = 0; n < selectedIndicators.length; n++) {
		            var valueCell = document.createElement('td');
		            var valueInput = document.createElement('input');
		            valueInput.type = 'number';
		            valueInput.value = wtmat[selectedScenario][n];
		            valueInput.min = '0';
		            valueInput.name = 'fmatrix[' + row + '][]';
		        	valueInput.style.width = '75px';
		            valueCell.appendChild(valueInput);
		            techRow.appendChild(valueCell);
		        }

		        // Add cells for the textboxes
		        for (var p = 0; p < textboxValues.length; p++) {
		            var textboxCell = document.createElement('td');
		            var textboxInput = document.createElement('input');
		            textboxInput.type = 'number';
		            textboxInput.value = '0';
		            textboxInput.min = '0';
		            textboxInput.name = 'fmatrix[' + row + '][]';
		        	textboxInput.style.width = '75px';
		            textboxCell.appendChild(textboxInput);
		            techRow.appendChild(textboxCell);
		        }

		        table.appendChild(techRow);
		    }
		    for (var m = 0; m < 1; m++) {
		    	row=row+1;
		        var techRow = document.createElement('tr');
		        var techCell = document.createElement('td');
		        var valueInput = document.createElement('input');
		        valueInput.type = 'textbox';
		        valueInput.value = '1-Cost 0-Benefit';
		        valueInput.name = 'fmatrix[' + row + '][]';
		        valueInput.style.width = '100px';
		        valueInput.disabled = true;
		        techCell.appendChild(valueInput);
		        techRow.appendChild(techCell);

		        for (var n = 0; n < selectedIndicators.length; n++) {
		            var valueCell = document.createElement('td');
		            var valueInput = document.createElement('input');
		            valueInput.type = 'number';
		            valueInput.min = '0';
		            valueInput.max = '1'
		            valueInput.value = cbmat[selectedScenario][n];//'0';
		            valueInput.name = 'fmatrix[' + row + '][]';
		        	valueInput.style.width = '75px';
		            valueCell.appendChild(valueInput);
		            techRow.appendChild(valueCell);
		        }

		        // Add cells for the textboxes
		        for (var p = 0; p < textboxValues.length; p++) {
		            var textboxCell = document.createElement('td');
		            var textboxInput = document.createElement('input');
		            textboxInput.type = 'number';
		            textboxInput.min = '0';
		            textboxInput.max='1';
		            textboxInput.value = '0';
		            textboxInput.name = 'fmatrix[' + row + '][]';
		        	textboxInput.style.width = '75px';
		            textboxCell.appendChild(textboxInput);
		            techRow.appendChild(textboxCell);
		        }

		        table.appendChild(techRow);
		    }

		    gridContainer.appendChild(table);
		    if(selectedIndicators.length+textboxValues.length >0 && selectedTechs.length+techboxValues.length >1){
		    	var submitNeoButton = document.getElementById('submitNeoButton');
            	submitNeoButton.style.display = 'block';
        	}
    	});

		document.getElementById('submitNeoButton').addEventListener('click', function(event) {
	    	event.preventDefault();
	    
		    // Retrieve the values of fmatrix inputs
		    var fmatrixInputs = Array.from(document.querySelectorAll('input[name^="fmatrix"]'));
		    
		    var fmatrix = [];
		    fmatrixInputs.forEach(function(input) {
		    	var rowId = input.name.match(/\[(\d+)\]/)[1];
		    	var colValue = input.value;
		    if (!fmatrix[rowId]) {
		      fmatrix[rowId] = [];
		    }
	    		fmatrix[rowId].push(colValue);
	  		});

		//----------------------------------------------------calculations--------------------
			var mainrow = fmatrix.length;
			var maincol = fmatrix[0].length;

			//technology names
			var t_techname = [];
			for(var i = 0; i < mainrow - 3; i++){
				t_techname[i] = fmatrix[i + 1][0];
			}

			//indicator names
			var t_indi_name = [];
			for(var j = 0; j < maincol - 1; j++){
				t_indi_name[j] = fmatrix[0][j + 1];
			}

			//decision matrix
			var decisionMatrix = [];
			for(var i = 0; i < mainrow - 3; i++){
				decisionMatrix[i] = [];
				for(var j = 0; j < maincol - 1; j++){
					decisionMatrix[i][j] = fmatrix[i + 1][j + 1];
				}
			}

			//weights
			var weights = [];
			for(var j = 0; j < maincol - 1; j++){
				weights[j] = fmatrix[mainrow - 2][j + 1];
			}

			//cost benefits
			var costbenefits = [];
			for(var j = 0; j < maincol - 1; j++){
				costbenefits[j] = fmatrix[mainrow - 1][j + 1];
			}

			//modify the decision matrix for negative values
			for(var j = 0; j < maincol - 1; j++){
				var min = Infinity;
				for(var i = 0; i < mainrow - 3; i++){
					min=Math.min(min, decisionMatrix[i][j]);
				}
				if (min < 0){
					for(var i = 0; i < mainrow - 3; i++){
						decisionMatrix[i][j] -= min;
					}
				}
			}

			//normalization of weights
			var sum_w = 0;
			for (var j = 0; j < maincol - 1; j++){
				sum_w += parseFloat(weights[j]);
			}
			for (var j = 0; j < maincol - 1; j++){
				weights[j] = weights[j]/sum_w;
			}

			//create normalizedMatrix
			var normalizedMatrix = [];
			for(var i = 0; i < decisionMatrix.length; i++){
				normalizedMatrix[i] = [];
				for(var j = 0; j < decisionMatrix[0].length; j++){
					normalizedMatrix[i][j] = decisionMatrix[i][j];
				}
			}

			//normalization of decision matrix
			var sum_d = 0;
			for(var j = 0; j < decisionMatrix[0].length; j++){
				sum_d = 0;
				for(var i = 0; i < decisionMatrix.length; i++){
					var xval = decisionMatrix[i][j];
					var sqrval = Math.pow(xval, 2);
					sum_d += parseFloat(sqrval);
				}
				var sqrtval = Math.sqrt(sum_d);
				for(var i = 0; i < decisionMatrix.length; i++){
					normalizedMatrix[i][j] = decisionMatrix[i][j] / sqrtval;
				}
			}

			//normalized matrix x normalized weights
			for(var i = 0; i < decisionMatrix.length; i++){
				for(var j = 0; j < decisionMatrix[0].length; j++){
					normalizedMatrix[i][j] = normalizedMatrix[i][j] * weights[j];
				}
			}

			//min and max for ideal solutions
			var positiveIdealSolution = [];
			var negativeIdealSolution = [];

			for (var j = 0; j < normalizedMatrix[0].length; j++){
				var max = 0;
				var min = Infinity;
				for (var i = 0; i < normalizedMatrix.length; i++){
					max = Math.max(max, normalizedMatrix[i][j]);
					min = Math.min(min, normalizedMatrix[i][j]);
				}
				positiveIdealSolution[j] = max;
				negativeIdealSolution[j] = min;
			}

			//positive and negative ideal solutions depending on cost benefits
			for(var i=0; i < costbenefits.length; i++){
				if(costbenefits[i]==1){
					var tempval = positiveIdealSolution[i];
					positiveIdealSolution[i]=negativeIdealSolution[i];
					negativeIdealSolution[i]=tempval;
				}
			}

			// Calculate the similarity distance
      		var similarityDistance = [];
      		for (var i = 0; i < normalizedMatrix.length; i++){
      			similarityDistance[i] = [];
      			var sumPositive = 0;
      			var sumNegative = 0;
      			for (var j = 0; j < normalizedMatrix[0].length; j++){
      				var xxval = normalizedMatrix[i][j] - positiveIdealSolution[j];
      				var xxval2 = Math.pow(xxval,2);
      				sumPositive += parseFloat(xxval2);
      				var yyval = normalizedMatrix[i][j] - negativeIdealSolution[j];
      				var yyval2 = Math.pow(yyval,2);
      				sumNegative += parseFloat(yyval2);
      			}
      			similarityDistance[i][0] = Math.sqrt(sumPositive);
      			similarityDistance[i][1] = Math.sqrt(sumNegative);
      		}

      		//relative closeness
      		var relativeCloseness = [];
      		for (var i = 0; i < similarityDistance.length; i++){
      			relativeCloseness[i] = similarityDistance[i][1] / (similarityDistance[i][1] + similarityDistance[i][0]);
      		}

      		// Create an array of objects with tech, value, and index
			var rankedArray = t_techname.map(function(value, index) {
			  return { t_techname: value, value: relativeCloseness[index], index: index };
			});

			// Sort the array in descending order based on the values
			rankedArray.sort(function(a, b) {
			  return b.value - a.value;
			});

			// Arrange the tech and relativeCloseness arrays based on the sorted ranks
			var sortedTech = rankedArray.map(function(item) {
			  return item.t_techname;
			});

			var sortedCloseness = rankedArray.map(function(item) {
			  return item.value.toFixed(4);
			});

			// Display the tech and relativeCloseness side by side
			var outputElement = document.getElementById("newmat");
			var outputHTML = "---------------------------------------\n";
			outputHTML +=  "Scores - Technology\n";
			outputHTML += "---------------------------------------\n";
			for (var i = 0; i < sortedTech.length; i++) {
			  outputHTML += sortedCloseness[i] + ' - ' + sortedTech[i] + '<br>';
			}
			outputHTML += "---------------------------------------\n";
			outputElement.innerHTML = outputHTML;

		    /*var outputElement = document.getElementById("newmat");
		    outputElement.innerHTML += JSON.stringify(relativeCloseness, null, 2);
		    outputElement.innerHTML += JSON.stringify(sortedTech, null, 2);*/
		    //outputElement.innerHTML +=console.log;
		});
		
		document.getElementById('submitNeoButton').style.display = 'none'; 
		//----------------------------------------------------------------------------------------------------
		const criteriaRadio = document.getElementById('opt_criteria2');
		const noCriteriaRadio = document.getElementById('opt_criteria1');
		const settingSelect = document.getElementById('settingSelect');
		const landSelect = document.getElementById('landSelect');
		const enduseSelect = document.getElementById('enduseSelect');

		criteriaRadio.addEventListener('change', function() {
		  const isChecked = this.checked;
		  settingSelect.disabled = !isChecked;
		  landSelect.disabled = !isChecked;
		  enduseSelect.disabled = !isChecked;
		});

		noCriteriaRadio.addEventListener('change', function() {
		  const isChecked = this.checked;
		  settingSelect.disabled = isChecked;
		  landSelect.disabled = isChecked;
		  enduseSelect.disabled = isChecked;
		});
		const form = document.querySelector('form');
		const output = document.getElementById('output');
		//----------------------------------------------------------------------------------------------------
    </script>
</body>
</html>
